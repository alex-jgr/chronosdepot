<?phpdefined('SYSPATH') or die('No direct script access.');use Facebook\FacebookSession;use Facebook\FacebookRedirectLoginHelper;use Facebook\FacebookRequest;/** * Description of Facebook * * @author Alexandru */class Kohana_Facebook {    protected $session;    protected $config;    protected $redirectHelper;        public function __construct($config = NULL) {        if (!$config) {            $this->config = Kohana::$config->load('facebook');        } else {            $this->config = $config;        }        FacebookSession::setDefaultApplication($this->config['appId'], $this->config['secret']);    }        public function getLoginUrl()    {        $redirectHelper = new FacebookRedirectLoginHelper($this->config['redirectUrl']);        return $redirectHelper->getLoginUrl(array('email'));    }    public function getRedirectHelper()    {        return $this->redirectHelper;    }        public function getUser()    {                $redirectHelper = new FacebookRedirectLoginHelper($this->config['redirectUrl']);        $session    = $redirectHelper->getSessionFromRedirect();        if ($session) {            $request    = new FacebookRequest($session, 'GET', '/me?fields=id,name,email,first_name,last_name,locale,timezone');            $response   = $request->execute();            return $response->getGraphObject('Facebook\GraphUser');        } else {            die('Check the cookie settings in bootstrap');        }    }}